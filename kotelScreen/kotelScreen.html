<html>

<body style="background-color:powderblue;">
    <table border="1">
        <tr>
            <td>

                <!-- Hebrew date libraries -->
                <script src="https://www.hebcal.com/etc/hdate-he.js"></script>
                <br>
                <script src="https://www.hebcal.com/etc/hdate-en.js"></script>
                <br>

                <!-- Simple ES5-compatible time check -->
                <script>
                    var now = new Date();
                    var hours = now.getHours();
                    var minutes = now.getMinutes();
                    var decimalTime = hours + (minutes / 60);

                    if (decimalTime >= 20.0 && decimalTime < 24.0) {
                        document.write('starting tonight');
                    } else {
                        document.write('until tonight');
                    }
                </script>

                <p>Powered by <a href="https://www.hebcal.com">Hebcal.com</a></p>
                <hr>

                <!-- Shabbat section -->
                <div id="hebcal-shabbat"></div>

                <script>
                    // Feature detection: use fetch if supported, otherwise XHR
                    var url = "https://www.hebcal.com/shabbat?cfg=i2&geonameid=294577&b=30&M=on&lg=s&tgt=_top";

                    if (window.fetch) {
                        // Modern browsers
                        fetch(url)
                            .then(function (response) { return response.text(); })
                            .then(function (data) {
                                document.getElementById('hebcal-shabbat').innerHTML = data;
                            })
                            .catch(function (err) {
                                console.log("Fetch failed, falling back to XHR:", err);
                                loadWithXHR();
                            });
                    } else {
                        // Old browsers immediately use XHR
                        loadWithXHR();
                    }

                    function loadWithXHR() {
                        var xhr = new XMLHttpRequest();
                        xhr.open("GET", url, true);

                        xhr.onreadystatechange = function () {
                            if (xhr.readyState === 4 && xhr.status === 200) {
                                document.getElementById('hebcal-shabbat').innerHTML = xhr.responseText;
                            }
                        };

                        xhr.send();
                    }
                </script>

            </td>

            <td>
                <!-- MyZmanim widget (unchanged) -->
                <script type="text/javascript" charset="UTF-8" language="javascript"
                    src="https://www.myzmanim.com/widget.aspx?lang=en&mode=Standard&fsize=13&fcolor=003BBE&hcolor=EBF1FF&bcolor=C0C0C0&suf=s&key=5z0sskm31T51cpL16ClOS5N%2bljoYc0NhWIVX0HIqaXQud3Df4SiB6gl4fuvpU2aBwmx5q2HhJW7UJ0ySTwt9yhhrtDACnWlyBbArESw%2b3x7eDgsijmwKQTPY32foKuz65zOngfVdoD2aL9qVlp6%2fs3z3KBHdXU9EFoDT15vA4SWF8ey9pXV9Gyi1yTriE4Px"></script>
                <noscript style="font-family:verdana;">Find your daily zmanim at <a
                        href="http://www.myzmanim.com/">MyZmanim.com</a>.</noscript>
            </td>

        </tr>
    </table>
</body>

</html>